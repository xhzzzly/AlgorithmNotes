# 数学

## 关键词

数学（最大公约数，GCD，最小公倍数，LCM，裴蜀定理，小素数判定，欧拉筛）

## 最大公约数（GCD）

C++17开始，可以直接用\<numeric\>中的 `gcd()`；之前好像也能用\<algorithm\>中的 `__gcd()`。

### 模版

```cpp
long long gcd(long long a, long long b) {
    while (b) {
        long long tmp = a;
        a = b;
        b = tmp % b;
    }
    return a;
}
```

## 最小公倍数（LCM）

同GCD可以直接用 `lcm(a, b)`。

### 模版

```cpp
long long lcm(long long a, long long b) {
    return a / gcd(a, b) * b;
}
```

## 裴蜀定理

### 表述

如果 $a$ 与 $b$ 均为整数，则有整数 $x$ 和 $y$ 使 $ax+by=\gcd(a,b)$。

## 素数

### 小素数判定

```cpp
bool isPrime(long long n) {
    if (n <= 1) return false;
    for (long long i = 2; i <= sqrt(n); ++i) if (n % i == 0) return false;
    return true;
}
```

### 欧拉筛

```cpp
vector<int> primes;
void euler_sieve(const long long &n) {
    vector<bool> vis(n + 3, false);
    primes.clear();
    for (int i = 2; i <= n; ++i) {
        if (!vis[i]) primes.emplace_back(i);
        for (int j = 0; j < primes.size(); ++j) {
            if (i * primes[j] > n) break;
            vis[i * primes[j]] = true;
            if (i % primes[j] == 0) break;
        }
    }
}
```

